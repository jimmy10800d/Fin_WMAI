<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>薪守村 — 冒險之旅</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/pages.css">
</head>
<body>
  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <img src="IP_ICON/IP_HELLO.png" alt="小曦雲" style="width:80px;height:80px;border-radius:50%;border:3px solid var(--color-gold);">
    <div class="village-title">薪 守 村</div>
    <div class="loading-text">正在進入村莊...</div>
    <div class="loading-spinner"></div>
  </div>

  <div class="app-layout" id="appLayout" style="display:none;">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <img src="IP_ICON/IP_HELLO.png" alt="薪守村">
          <span class="village-name">薪守村</span>
          <span class="village-subtitle">守護你的 1st Salary</span>
        </div>
      </div>

      <!-- Player Card -->
      <div class="player-card" id="playerCard">
        <div class="player-name" id="playerName">冒險者</div>
        <div class="player-class" id="playerClass">初心者</div>
        <div class="xp-bar-container">
          <div class="xp-bar-fill" id="xpBarFill" style="width:0%"></div>
          <span class="xp-bar-text" id="xpBarText">0 / 100 XP</span>
        </div>
        <div class="player-level">
          <span class="level-badge" id="levelBadge">R1</span>
          <span id="playerTitle">初心者</span>
        </div>
        <div class="player-stars" id="playerStars">★☆☆☆☆</div>
      </div>

      <!-- Quest Navigation -->
      <nav class="quest-nav" id="questNav">
        <div class="nav-section-title">冒險旅程</div>

        <div class="nav-item active" data-page="home" onclick="navigateTo('home')">
          <div class="nav-icon">🏠</div>
          <span class="nav-label">村莊廣場</span>
          <span class="quest-status completed"></span>
        </div>

        <div class="nav-section-title">主線任務</div>

        <div class="nav-item" data-page="goals" onclick="navigateTo('goals')">
          <div class="nav-icon">🌟</div>
          <span class="nav-label">初心者 — 目標設定</span>
          <span class="quest-status available"></span>
        </div>

        <div class="nav-item" data-page="profile" onclick="navigateTo('profile')">
          <div class="nav-icon">🛡️</div>
          <span class="nav-label">職業說明NPC</span>
          <span class="quest-status locked"></span>
        </div>

        <div class="nav-item" data-page="recommendation" onclick="navigateTo('recommendation')">
          <div class="nav-icon">⚔️</div>
          <span class="nav-label">專屬特殊技能</span>
          <span class="quest-status locked"></span>
        </div>

        <div class="nav-item" data-page="execution" onclick="navigateTo('execution')">
          <div class="nav-icon">🏰</div>
          <span class="nav-label">攻克據點</span>
          <span class="quest-status locked"></span>
        </div>

        <div class="nav-item" data-page="dashboard" onclick="navigateTo('dashboard')">
          <div class="nav-icon">🏆</div>
          <span class="nav-label">戰績回顧</span>
          <span class="quest-status locked"></span>
        </div>

        <div class="nav-section-title">支線任務</div>

        <div class="nav-item" data-page="share" onclick="navigateTo('share')">
          <div class="nav-icon">📜</div>
          <span class="nav-label">冒險日誌分享</span>
          <span class="quest-status locked"></span>
        </div>

        <div class="nav-item" data-page="allies" onclick="navigateTo('allies')">
          <div class="nav-icon">🤝</div>
          <span class="nav-label">盟友中心</span>
          <span class="quest-status locked"></span>
        </div>

        <div class="nav-section-title">小㬢雲管理</div>

        <div class="nav-item" data-page="assistant" onclick="navigateTo('assistant')">
          <div class="nav-icon">🧠</div>
          <span class="nav-label">AI 助理管理</span>
          <span class="quest-status available"></span>
        </div>
      </nav>

      <!-- Sidebar Footer -->
      <div class="sidebar-footer">
        <div class="footer-actions">
          <button class="theme-toggle" onclick="toggleTheme()" title="切換主題">
            <i class="fas fa-moon" id="themeIcon"></i>
          </button>
          <span style="font-size:0.72rem;color:var(--text-sidebar);">v1.1</span>
          <button class="logout-btn" onclick="logout()" title="離開村莊">
            <i class="fas fa-door-open"></i>
          </button>
        </div>
      </div>
    </aside>

    <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

    <!-- Main Area -->
    <div class="main-area">
      <!-- Top Header -->
      <header class="top-header">
        <div class="header-left">
          <button class="menu-toggle" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
          </button>
          <div class="page-title-area">
            <h1 id="pageTitle">村莊廣場</h1>
            <div class="breadcrumb" id="breadcrumb">薪守村 / 村莊廣場</div>
          </div>
        </div>
        <div class="header-right">
          <button class="header-btn" onclick="toggleNotifications()" title="村莊公告">
            <i class="fas fa-bell"></i>
            <span class="badge" id="notifBadge">3</span>
          </button>
          <button class="header-btn" onclick="toggleChatbot()" title="呼叫小曦雲 NPC">
            <i class="fas fa-comment-dots"></i>
          </button>
        </div>
      </header>

      <!-- Main Content -->
      <main class="main-content" id="mainContent">
        <!-- Dynamic page content loaded here -->
      </main>
    </div>
  </div>

  <!-- Risk Disclosure Modal -->
  <div class="modal-overlay" id="riskModal">
    <div class="modal">
      <div class="modal-header">
        <h2><i class="fas fa-shield-halved"></i> 風險揭露聲明</h2>
        <button class="modal-close" onclick="closeRiskModal()">&times;</button>
      </div>
      <div id="riskModalBody">
        <div class="npc-dialog">
          <img src="IP_ICON/IP_THINKING.png" alt="小曦雲" class="npc-avatar">
          <div class="npc-bubble">
            <div class="npc-name">NPC 小曦雲 — 風險提醒</div>
            <p>冒險者，在你繼續之前，有些重要的事情必須先了解：</p>
          </div>
        </div>
        <div class="card mt-2" style="border-left:4px solid var(--color-orange);">
          <h3 style="font-size:0.9rem;margin-bottom:8px;">⚠️ 投資風險聲明</h3>
          <ul style="font-size:0.82rem;line-height:1.8;padding-left:20px;color:var(--text-secondary);">
            <li>投資一定有風險，基金投資有賺有賠</li>
            <li>申購前應詳閱公開說明書</li>
            <li>過去績效不代表未來收益</li>
            <li>系統建議僅供參考，非投資建議</li>
            <li>最壞情況下，您可能損失部分或全部投資本金</li>
          </ul>
        </div>
        <div class="card mt-2" style="border-left:4px solid var(--color-blue);">
          <h3 style="font-size:0.9rem;margin-bottom:8px;">📋 適合性聲明</h3>
          <p style="font-size:0.82rem;color:var(--text-secondary);line-height:1.6;">
            本系統依據您的風險屬性與投資目標提供個人化建議。如建議內容與您的認知不符，請立即向理財專員諮詢。您有權隨時終止或調整投資計劃。
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="closeRiskModal()">稍後再看</button>
        <button class="btn btn-gold" onclick="acknowledgeRisk()">
          <i class="fas fa-check"></i> 我已了解風險
        </button>
      </div>
    </div>
  </div>

  <!-- Notification Panel -->
  <div class="modal-overlay" id="notifModal">
    <div class="modal">
      <div class="modal-header">
        <h2><i class="fas fa-bell"></i> 村莊公告</h2>
        <button class="modal-close" onclick="closeNotifications()">&times;</button>
      </div>
      <div id="notifList">
        <div class="card mb-2" style="border-left:4px solid var(--color-gold);">
          <div style="font-size:0.75rem;color:var(--color-gold);font-weight:600;">🏆 成就解鎖</div>
          <p style="font-size:0.85rem;margin-top:4px;">恭喜！你已成功登入薪守村，獲得「初心者」稱號</p>
          <div style="font-size:0.68rem;color:var(--text-muted);margin-top:4px;">剛剛</div>
        </div>
        <div class="card mb-2" style="border-left:4px solid var(--color-green);">
          <div style="font-size:0.75rem;color:var(--color-green);font-weight:600;">📋 新任務</div>
          <p style="font-size:0.85rem;margin-top:4px;">主線任務「初心者 — 目標設定」已解鎖！</p>
          <div style="font-size:0.68rem;color:var(--text-muted);margin-top:4px;">1 分鐘前</div>
        </div>
        <div class="card mb-2" style="border-left:4px solid var(--color-blue);">
          <div style="font-size:0.75rem;color:var(--color-blue);font-weight:600;">📰 市場情報</div>
          <p style="font-size:0.85rem;margin-top:4px;">今日台股加權指數上漲 0.8%，AI 概念股表現亮眼</p>
          <div style="font-size:0.68rem;color:var(--text-muted);margin-top:4px;">30 分鐘前</div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline btn-sm" onclick="closeNotifications()">關閉</button>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Chatbot Panel -->
  <button class="chatbot-toggle" id="chatbotToggle" onclick="toggleChatbot()">
    <img src="IP_ICON/IP_HELLO.png" alt="小曦雲">
  </button>

  <div class="chatbot-panel" id="chatbotPanel">
    <div class="chatbot-header">
      <div class="npc-info">
        <img src="IP_ICON/IP_HELLO.png" alt="小曦雲">
        <span>NPC 小曦雲</span>
      </div>
      <button class="close-chat" onclick="toggleChatbot()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="chatbot-messages" id="chatMessages">
      <div class="npc-dialog">
        <img src="IP_ICON/IP_HELLO.png" alt="小曦雲" class="npc-avatar" style="width:32px;height:32px;">
        <div class="npc-bubble">
          <div class="npc-name">小曦雲</div>
          嗨～我是你的專屬 NPC 嚮導小曦雲！有任何關於理財冒險的問題都可以問我喔 ✨
        </div>
      </div>
    </div>
    <div class="chatbot-input-area">
      <input type="text" id="chatInput" placeholder="向小曦雲提問..." onkeydown="if(event.key==='Enter')sendChat()">
      <button onclick="sendChat()"><i class="fas fa-paper-plane"></i></button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/data-service.js"></script>
  <script src="js/app.js"></script>
  <script src="js/pages/home.js"></script>
  <script src="js/pages/goals.js"></script>
  <script src="js/pages/profile.js"></script>
  <script src="js/pages/recommendation.js"></script>
  <script src="js/pages/execution.js"></script>
  <script src="js/pages/dashboard.js"></script>
  <script src="js/pages/share.js"></script>
  <script src="js/pages/allies.js"></script>
  <script src="js/pages/assistant.js"></script>
  <script src="js/chatbot.js"></script>
  <script src="js/demo.js"></script>
</body>
</html>
