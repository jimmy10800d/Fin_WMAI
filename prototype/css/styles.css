/* ================================================
   薪守村 (Fin_WMAI) — RPG 遊戲化設計系統
   Design System: 村莊冒險風格
   ================================================ */

:root {
  --bg-primary: #f5efe0;
  --bg-secondary: #ebe3d1;
  --bg-card: #faf6ec;
  --bg-sidebar: #2d3b2d;
  --bg-sidebar-hover: #3a4f3a;
  --bg-sidebar-active: #4a6b4a;
  --bg-header: rgba(245,239,224,0.95);
  --text-primary: #3a2718;
  --text-secondary: #6b5b4e;
  --text-muted: #9e8e7e;
  --text-inverse: #f5efe0;
  --text-sidebar: #c8d8c0;
  --text-sidebar-active: #ffe082;
  --color-gold: #d4a843;
  --color-gold-light: #f0d68a;
  --color-gold-dark: #b8912e;
  --color-green: #4a7c59;
  --color-green-light: #6aad7a;
  --color-green-dark: #2d5a3d;
  --color-orange: #e67e22;
  --color-red: #c0392b;
  --color-red-light: #e74c3c;
  --color-blue: #2980b9;
  --color-blue-light: #5dade2;
  --color-purple: #8e44ad;
  --border-color: #d4c5a9;
  --border-color-strong: #b8a88a;
  --shadow-sm: 0 2px 4px rgba(58,39,24,0.08);
  --shadow-md: 0 4px 12px rgba(58,39,24,0.12);
  --shadow-lg: 0 8px 24px rgba(58,39,24,0.16);
  --shadow-glow-gold: 0 0 12px rgba(212,168,67,0.4);
  --radius-sm: 6px;
  --radius-md: 12px;
  --radius-lg: 20px;
  --radius-xl: 28px;
  --radius-pill: 50px;
  --font-main: 'Noto Sans TC', sans-serif;
  --sidebar-width: 260px;
  --header-height: 64px;
  --transition: 0.3s ease;
}

[data-theme="dark"] {
  --bg-primary: #1a2332;
  --bg-secondary: #22303f;
  --bg-card: #263545;
  --bg-sidebar: #0f1923;
  --bg-sidebar-hover: #1a2a3a;
  --bg-sidebar-active: #243a4d;
  --bg-header: rgba(26,35,50,0.95);
  --text-primary: #e8dcc8;
  --text-secondary: #b8a88a;
  --text-muted: #7a6e5e;
  --text-inverse: #1a2332;
  --text-sidebar: #8a9eae;
  --text-sidebar-active: #ffe082;
  --border-color: #3a4a5a;
  --border-color-strong: #4a5a6a;
  --shadow-sm: 0 2px 4px rgba(0,0,0,0.2);
  --shadow-md: 0 4px 12px rgba(0,0,0,0.3);
  --shadow-lg: 0 8px 24px rgba(0,0,0,0.4);
}

*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{font-family:var(--font-main);background:var(--bg-primary);color:var(--text-primary);line-height:1.6;min-height:100vh;overflow-x:hidden;}
a{color:var(--color-green);text-decoration:none;}
a:hover{color:var(--color-green-light);}

/* === Layout === */
.app-layout{display:flex;min-height:100vh;}

/* === Sidebar === */
.sidebar{width:var(--sidebar-width);background:var(--bg-sidebar);display:flex;flex-direction:column;position:fixed;top:0;left:0;height:100vh;z-index:100;transition:transform var(--transition);border-right:2px solid rgba(212,168,67,0.2);}
.sidebar-header{padding:20px;text-align:center;border-bottom:1px solid rgba(255,255,255,0.08);}
.sidebar-logo{display:flex;flex-direction:column;align-items:center;gap:8px;}
.sidebar-logo img{width:56px;height:56px;border-radius:50%;border:2px solid var(--color-gold);box-shadow:var(--shadow-glow-gold);}
.sidebar-logo .village-name{font-size:1.1rem;font-weight:700;color:var(--color-gold);letter-spacing:2px;}
.sidebar-logo .village-subtitle{font-size:0.72rem;color:var(--text-sidebar);opacity:0.7;}

/* Player Card */
.player-card{margin:12px 16px;padding:12px;background:rgba(255,255,255,0.05);border-radius:var(--radius-md);border:1px solid rgba(212,168,67,0.15);}
.player-card .player-name{font-size:0.9rem;font-weight:600;color:var(--text-sidebar-active);}
.player-card .player-class{font-size:0.75rem;color:var(--text-sidebar);margin-bottom:8px;}
.xp-bar-container{position:relative;height:16px;background:rgba(0,0,0,0.3);border-radius:var(--radius-pill);overflow:hidden;border:1px solid rgba(212,168,67,0.2);}
.xp-bar-fill{height:100%;background:linear-gradient(90deg,var(--color-gold-dark),var(--color-gold),var(--color-gold-light));border-radius:var(--radius-pill);transition:width 0.8s ease;position:relative;overflow:hidden;}
.xp-bar-fill::after{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.3),transparent);animation:xpShimmer 2s infinite;}
@keyframes xpShimmer{to{left:100%;}}
.xp-bar-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:0.65rem;font-weight:700;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,0.5);z-index:1;}
.player-level{display:flex;justify-content:space-between;align-items:center;margin-top:6px;font-size:0.72rem;color:var(--text-sidebar);}
.player-level .level-badge{background:var(--color-gold);color:#3a2718;padding:1px 8px;border-radius:var(--radius-pill);font-weight:700;font-size:0.68rem;}

/* Quest Nav */
.quest-nav{flex:1;overflow-y:auto;padding:8px 0;}
.quest-nav .nav-section-title{padding:12px 20px 4px;font-size:0.68rem;font-weight:700;color:var(--color-gold);text-transform:uppercase;letter-spacing:2px;opacity:0.7;}
.quest-nav .nav-item{display:flex;align-items:center;gap:12px;padding:10px 20px;color:var(--text-sidebar);cursor:pointer;transition:all var(--transition);position:relative;border-left:3px solid transparent;}
.quest-nav .nav-item:hover{background:var(--bg-sidebar-hover);color:#fff;}
.quest-nav .nav-item.active{background:var(--bg-sidebar-active);color:var(--text-sidebar-active);border-left-color:var(--color-gold);}
.quest-nav .nav-item .nav-icon{width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:var(--radius-sm);font-size:0.9rem;flex-shrink:0;}
.quest-nav .nav-item .nav-label{font-size:0.85rem;font-weight:500;flex:1;}
.quest-nav .nav-item .nav-stage{font-size:0.62rem;color:var(--text-muted);opacity:0.6;}
.quest-nav .nav-item .quest-status{width:8px;height:8px;border-radius:50%;flex-shrink:0;}
.quest-status.locked{background:#666;}
.quest-status.available{background:var(--color-orange);animation:pulse 2s infinite;}
.quest-status.in-progress{background:var(--color-blue-light);animation:pulse 2s infinite;}
.quest-status.completed{background:var(--color-green-light);}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1);}50%{opacity:0.6;transform:scale(1.3);}}

/* Sidebar Footer */
.sidebar-footer{padding:12px 16px;border-top:1px solid rgba(255,255,255,0.08);}
.sidebar-footer .footer-actions{display:flex;justify-content:space-between;align-items:center;}
.sidebar-footer .theme-toggle,.sidebar-footer .logout-btn{background:none;border:none;color:var(--text-sidebar);cursor:pointer;padding:8px;border-radius:var(--radius-sm);transition:all var(--transition);font-size:0.85rem;}
.sidebar-footer .theme-toggle:hover,.sidebar-footer .logout-btn:hover{background:var(--bg-sidebar-hover);color:#fff;}

/* === Main Area === */
.main-area{flex:1;margin-left:var(--sidebar-width);display:flex;flex-direction:column;min-height:100vh;}
.top-header{height:var(--header-height);background:var(--bg-header);backdrop-filter:blur(10px);border-bottom:1px solid var(--border-color);display:flex;align-items:center;justify-content:space-between;padding:0 24px;position:sticky;top:0;z-index:50;}
.header-left{display:flex;align-items:center;gap:16px;}
.menu-toggle{display:none;background:none;border:none;font-size:1.3rem;color:var(--text-primary);cursor:pointer;padding:4px;}
.page-title-area h1{font-size:1.15rem;font-weight:700;color:var(--text-primary);}
.page-title-area .breadcrumb{font-size:0.72rem;color:var(--text-muted);}
.header-right{display:flex;align-items:center;gap:12px;}
.header-right .header-btn{background:none;border:none;color:var(--text-secondary);cursor:pointer;padding:8px;border-radius:var(--radius-sm);font-size:1rem;position:relative;transition:all var(--transition);}
.header-right .header-btn:hover{background:var(--bg-secondary);color:var(--text-primary);}
.header-right .header-btn .badge{position:absolute;top:2px;right:2px;width:16px;height:16px;background:var(--color-red);color:#fff;font-size:0.6rem;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;}
.main-content{flex:1;padding:24px;max-width:1200px;width:100%;margin:0 auto;}

/* === Cards === */
.card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:var(--radius-md);padding:24px;box-shadow:var(--shadow-sm);transition:all var(--transition);}
.card:hover{box-shadow:var(--shadow-md);}
.card-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;padding-bottom:12px;border-bottom:1px dashed var(--border-color);}
.card-header h3{font-size:1rem;font-weight:700;color:var(--text-primary);display:flex;align-items:center;gap:8px;}
.card-header .card-badge{font-size:0.65rem;padding:2px 8px;border-radius:var(--radius-pill);font-weight:600;}

/* Quest Card */
.quest-card{background:var(--bg-card);border:2px solid var(--border-color);border-radius:var(--radius-lg);overflow:hidden;transition:all var(--transition);cursor:pointer;}
.quest-card:hover{border-color:var(--color-gold);box-shadow:var(--shadow-glow-gold);transform:translateY(-2px);}
.quest-card.locked{opacity:0.5;pointer-events:none;filter:grayscale(0.5);}
.quest-card .quest-banner{height:8px;}
.quest-card.stage-1 .quest-banner{background:linear-gradient(90deg,#4CAF50,#8BC34A);}
.quest-card.stage-2 .quest-banner{background:linear-gradient(90deg,#2196F3,#03A9F4);}
.quest-card.stage-3 .quest-banner{background:linear-gradient(90deg,#9C27B0,#E040FB);}
.quest-card.stage-4 .quest-banner{background:linear-gradient(90deg,#FF5722,#FF9800);}
.quest-card.stage-5 .quest-banner{background:linear-gradient(90deg,#FFD700,#FFA000);}
.quest-card .quest-body{padding:20px;}
.quest-card .quest-stage-label{font-size:0.68rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;margin-bottom:4px;}
.quest-card .quest-title{font-size:1.05rem;font-weight:700;color:var(--text-primary);margin-bottom:8px;}
.quest-card .quest-desc{font-size:0.82rem;color:var(--text-secondary);line-height:1.5;margin-bottom:12px;}
.quest-card .quest-footer{display:flex;justify-content:space-between;align-items:center;}
.quest-card .quest-reward{display:flex;align-items:center;gap:4px;font-size:0.75rem;color:var(--color-gold);font-weight:600;}

/* === Buttons === */
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 20px;border:none;border-radius:var(--radius-md);font-family:var(--font-main);font-size:0.88rem;font-weight:600;cursor:pointer;transition:all var(--transition);text-decoration:none;}
.btn-primary{background:linear-gradient(135deg,var(--color-green),var(--color-green-dark));color:#fff;box-shadow:0 2px 8px rgba(45,90,61,0.3);}
.btn-primary:hover{background:linear-gradient(135deg,var(--color-green-light),var(--color-green));transform:translateY(-1px);box-shadow:0 4px 12px rgba(45,90,61,0.4);}
.btn-gold{background:linear-gradient(135deg,var(--color-gold),var(--color-gold-dark));color:#3a2718;box-shadow:0 2px 8px rgba(212,168,67,0.3);}
.btn-gold:hover{background:linear-gradient(135deg,var(--color-gold-light),var(--color-gold));transform:translateY(-1px);box-shadow:var(--shadow-glow-gold);}
.btn-outline{background:transparent;border:2px solid var(--border-color-strong);color:var(--text-primary);}
.btn-outline:hover{border-color:var(--color-gold);color:var(--color-gold);background:rgba(212,168,67,0.08);}
.btn-danger{background:linear-gradient(135deg,var(--color-red),#a93226);color:#fff;}
.btn-sm{padding:6px 14px;font-size:0.78rem;}
.btn-lg{padding:14px 28px;font-size:1rem;}
.btn-block{width:100%;}
.btn:disabled{opacity:0.5;cursor:not-allowed;transform:none!important;}

/* === Progress === */
.progress-bar{height:8px;background:var(--bg-secondary);border-radius:var(--radius-pill);overflow:hidden;}
.progress-bar .progress-fill{height:100%;border-radius:var(--radius-pill);background:linear-gradient(90deg,var(--color-green),var(--color-green-light));transition:width 0.8s ease;}
.progress-bar.gold .progress-fill{background:linear-gradient(90deg,var(--color-gold-dark),var(--color-gold),var(--color-gold-light));}

/* Stage Progress */
.stage-progress{display:flex;align-items:center;gap:0;padding:16px 0;}
.stage-progress .stage-step{display:flex;flex-direction:column;align-items:center;flex:1;position:relative;}
.stage-progress .stage-step::after{content:'';position:absolute;top:16px;left:50%;width:100%;height:3px;background:var(--border-color);z-index:0;}
.stage-progress .stage-step:last-child::after{display:none;}
.stage-progress .stage-step.completed::after{background:var(--color-green);}
.stage-progress .stage-step.active::after{background:linear-gradient(90deg,var(--color-green) 50%,var(--border-color) 50%);}
.stage-progress .stage-dot{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.75rem;font-weight:700;z-index:1;transition:all var(--transition);border:2px solid var(--border-color);background:var(--bg-card);color:var(--text-muted);}
.stage-progress .stage-step.completed .stage-dot{background:var(--color-green);border-color:var(--color-green);color:#fff;}
.stage-progress .stage-step.active .stage-dot{background:var(--color-gold);border-color:var(--color-gold);color:#3a2718;box-shadow:var(--shadow-glow-gold);animation:pulse 2s infinite;}
.stage-progress .stage-label{font-size:0.65rem;color:var(--text-muted);margin-top:6px;text-align:center;max-width:80px;}
.stage-progress .stage-step.completed .stage-label{color:var(--color-green);}
.stage-progress .stage-step.active .stage-label{color:var(--color-gold);font-weight:600;}

/* === Stats Grid === */
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;}
.stat-card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:var(--radius-md);padding:20px;text-align:center;transition:all var(--transition);}
.stat-card:hover{border-color:var(--color-gold);box-shadow:var(--shadow-md);}
.stat-card .stat-icon{font-size:1.5rem;margin-bottom:8px;}
.stat-card .stat-value{font-size:1.5rem;font-weight:800;color:var(--text-primary);}
.stat-card .stat-label{font-size:0.75rem;color:var(--text-secondary);margin-top:4px;}

/* === Achievement === */
.achievement{display:inline-flex;align-items:center;gap:8px;padding:8px 16px;background:linear-gradient(135deg,rgba(212,168,67,0.1),rgba(212,168,67,0.05));border:1px solid rgba(212,168,67,0.3);border-radius:var(--radius-pill);font-size:0.78rem;color:var(--color-gold-dark);font-weight:600;}
.achievement .achievement-icon{font-size:1.1rem;}

/* === Modal === */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;visibility:hidden;transition:all var(--transition);backdrop-filter:blur(4px);}
.modal-overlay.active{opacity:1;visibility:visible;}
.modal{background:var(--bg-card);border:2px solid var(--border-color);border-radius:var(--radius-lg);max-width:560px;width:90%;max-height:85vh;overflow-y:auto;padding:32px;transform:translateY(20px) scale(0.95);transition:all var(--transition);box-shadow:var(--shadow-lg);}
.modal-overlay.active .modal{transform:translateY(0) scale(1);}
.modal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;padding-bottom:16px;border-bottom:2px solid var(--border-color);}
.modal-header h2{font-size:1.15rem;font-weight:700;display:flex;align-items:center;gap:8px;}
.modal-close{background:none;border:none;font-size:1.2rem;color:var(--text-muted);cursor:pointer;padding:4px 8px;border-radius:var(--radius-sm);}
.modal-close:hover{background:var(--bg-secondary);color:var(--text-primary);}
.modal-footer{margin-top:24px;display:flex;justify-content:flex-end;gap:12px;padding-top:16px;border-top:1px solid var(--border-color);}

/* === Toast === */
.toast-container{position:fixed;top:80px;right:24px;z-index:2000;display:flex;flex-direction:column;gap:8px;}
.toast{background:var(--bg-card);border:1px solid var(--border-color);border-radius:var(--radius-md);padding:14px 20px;box-shadow:var(--shadow-lg);display:flex;align-items:center;gap:12px;min-width:280px;max-width:400px;transform:translateX(120%);transition:transform 0.4s ease;}
.toast.show{transform:translateX(0);}
.toast.success{border-left:4px solid var(--color-green);}
.toast.warning{border-left:4px solid var(--color-orange);}
.toast.error{border-left:4px solid var(--color-red);}
.toast.info{border-left:4px solid var(--color-blue);}
.toast.achievement-toast{border-left:4px solid var(--color-gold);border-color:rgba(212,168,67,0.3);background:linear-gradient(135deg,var(--bg-card),rgba(212,168,67,0.05));}
.toast .toast-icon{font-size:1.1rem;flex-shrink:0;}
.toast .toast-message{font-size:0.82rem;flex:1;}

/* === Tags === */
.tag{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;border-radius:var(--radius-pill);font-size:0.7rem;font-weight:600;}
.tag-green{background:rgba(74,124,89,0.12);color:var(--color-green);}
.tag-gold{background:rgba(212,168,67,0.12);color:var(--color-gold-dark);}
.tag-blue{background:rgba(41,128,185,0.12);color:var(--color-blue);}
.tag-orange{background:rgba(230,126,34,0.12);color:var(--color-orange);}
.tag-red{background:rgba(192,57,43,0.12);color:var(--color-red);}
.tag-purple{background:rgba(142,68,173,0.12);color:var(--color-purple);}

/* === NPC Dialog === */
.npc-dialog{display:flex;gap:12px;align-items:flex-start;margin-bottom:20px;}
.npc-avatar{width:64px;height:64px;border-radius:50%;border:2px solid var(--color-gold);flex-shrink:0;object-fit:cover;}
.npc-avatar-lg{width:96px;height:96px;border-radius:50%;border:3px solid var(--color-gold);object-fit:cover;filter:drop-shadow(0 4px 12px rgba(255,215,0,0.3));}
.npc-avatar-xl{width:120px;height:120px;border-radius:16px;border:3px solid var(--color-gold);object-fit:cover;filter:drop-shadow(0 6px 20px rgba(255,215,0,0.35));animation:ip-float 3s ease-in-out infinite;}
@keyframes ip-float{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
.npc-bubble{background:var(--bg-card);border:1px solid var(--border-color);border-radius:2px var(--radius-md) var(--radius-md) var(--radius-md);padding:14px 18px;font-size:0.88rem;line-height:1.6;position:relative;max-width:85%;box-shadow:var(--shadow-sm);}
.npc-bubble .npc-name{font-size:0.72rem;font-weight:700;color:var(--color-gold);margin-bottom:4px;}

/* === Mission Checklist === */
.mission-checklist{list-style:none;}
.mission-checklist li{display:flex;align-items:center;gap:10px;padding:10px 0;border-bottom:1px dashed var(--border-color);font-size:0.85rem;}
.mission-checklist li:last-child{border-bottom:none;}
.mission-checklist .check-icon{width:22px;height:22px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.7rem;flex-shrink:0;}
.mission-checklist .check-icon.done{background:var(--color-green);color:#fff;}
.mission-checklist .check-icon.pending{border:2px solid var(--border-color);color:var(--text-muted);}
.mission-checklist .check-icon.active{border:2px solid var(--color-gold);color:var(--color-gold);animation:pulse 2s infinite;}

/* === Form === */
.form-group{margin-bottom:16px;}
.form-group label{display:block;font-size:0.82rem;font-weight:600;color:var(--text-primary);margin-bottom:6px;}
.form-input,.form-select,.form-textarea{width:100%;padding:10px 14px;border:1px solid var(--border-color);border-radius:var(--radius-md);background:var(--bg-card);color:var(--text-primary);font-family:var(--font-main);font-size:0.88rem;transition:all var(--transition);}
.form-input:focus,.form-select:focus,.form-textarea:focus{outline:none;border-color:var(--color-gold);box-shadow:0 0 0 3px rgba(212,168,67,0.15);}
.form-textarea{resize:vertical;min-height:100px;}

/* === Chatbot === */
.chatbot-toggle{position:fixed;bottom:24px;right:24px;width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--color-green),var(--color-green-dark));border:3px solid var(--color-gold);box-shadow:var(--shadow-lg),var(--shadow-glow-gold);cursor:pointer;z-index:500;display:flex;align-items:center;justify-content:center;transition:all var(--transition);overflow:hidden;}
.chatbot-toggle img{width:100%;height:100%;object-fit:cover;}
.chatbot-toggle:hover{transform:scale(1.1);}
.chatbot-panel{position:fixed;bottom:90px;right:24px;width:380px;height:520px;background:var(--bg-card);border:2px solid var(--border-color);border-radius:var(--radius-lg);box-shadow:var(--shadow-lg);display:flex;flex-direction:column;z-index:500;transform:translateY(20px) scale(0.9);opacity:0;visibility:hidden;transition:all 0.3s ease;}
.chatbot-panel.open{transform:translateY(0) scale(1);opacity:1;visibility:visible;}
.chatbot-header{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid var(--border-color);background:var(--bg-sidebar);border-radius:var(--radius-lg) var(--radius-lg) 0 0;}
.chatbot-header .npc-info{display:flex;align-items:center;gap:10px;}
.chatbot-header .npc-info img{width:32px;height:32px;border-radius:50%;border:2px solid var(--color-gold);}
.chatbot-header .npc-info span{color:var(--text-sidebar-active);font-weight:700;font-size:0.9rem;}
.chatbot-header .close-chat{background:none;border:none;color:var(--text-sidebar);font-size:1.1rem;cursor:pointer;}
.chatbot-messages{flex:1;overflow-y:auto;padding:16px;}
.chatbot-input-area{padding:12px 16px;border-top:1px solid var(--border-color);display:flex;gap:8px;}
.chatbot-input-area input{flex:1;padding:10px 14px;border:1px solid var(--border-color);border-radius:var(--radius-pill);background:var(--bg-primary);color:var(--text-primary);font-family:var(--font-main);font-size:0.85rem;}
.chatbot-input-area input:focus{outline:none;border-color:var(--color-gold);}
.chatbot-input-area button{width:40px;height:40px;border-radius:50%;background:var(--color-green);color:#fff;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;}

/* === Loading Overlay === */
.loading-overlay{position:fixed;inset:0;background:#1a2332;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;transition:opacity 0.5s ease;}
.loading-overlay.hide{opacity:0;pointer-events:none;}
.loading-overlay .village-title{font-size:2rem;font-weight:800;color:var(--color-gold);margin-top:20px;letter-spacing:4px;}
.loading-overlay .loading-text{font-size:0.88rem;color:#8a9eae;margin-top:8px;}
.loading-spinner{width:48px;height:48px;border:3px solid rgba(212,168,67,0.2);border-top-color:var(--color-gold);border-radius:50%;animation:spin 1s linear infinite;margin-top:20px;}
@keyframes spin{to{transform:rotate(360deg);}}

/* === Utilities === */
.text-center{text-align:center;}
.text-gold{color:var(--color-gold);}
.text-green{color:var(--color-green);}
.text-red{color:var(--color-red);}
.text-muted{color:var(--text-muted);}
.mt-1{margin-top:8px;}.mt-2{margin-top:16px;}.mt-3{margin-top:24px;}
.mb-1{margin-bottom:8px;}.mb-2{margin-bottom:16px;}.mb-3{margin-bottom:24px;}
.gap-1{gap:8px;}.gap-2{gap:16px;}
.flex{display:flex;}.flex-col{flex-direction:column;}.items-center{align-items:center;}.justify-between{justify-content:space-between;}
.grid-2{display:grid;grid-template-columns:repeat(2,1fr);gap:16px;}
.grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;}
.hidden{display:none!important;}
.w-full{width:100%;}

/* === Responsive === */
@media(max-width:768px){
  .sidebar{transform:translateX(-100%);}
  .sidebar.open{transform:translateX(0);}
  .main-area{margin-left:0;}
  .menu-toggle{display:block;}
  .main-content{padding:16px;}
  .grid-2,.grid-3{grid-template-columns:1fr;}
  .stats-grid{grid-template-columns:repeat(2,1fr);}
  .chatbot-panel{width:calc(100% - 32px);right:16px;bottom:80px;height:60vh;}
  .stage-progress{overflow-x:auto;}
}
@media(max-width:480px){.stats-grid{grid-template-columns:1fr;}}

/* === Animations === */
@keyframes fadeIn{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}
@keyframes slideInLeft{from{opacity:0;transform:translateX(-20px);}to{opacity:1;transform:translateX(0);}}
@keyframes scaleIn{from{opacity:0;transform:scale(0.8);}to{opacity:1;transform:scale(1);}}
@keyframes glow{0%,100%{box-shadow:var(--shadow-glow-gold);}50%{box-shadow:0 0 20px rgba(212,168,67,0.6);}}
.animate-fadeIn{animation:fadeIn 0.5s ease forwards;}
.animate-slideIn{animation:slideInLeft 0.5s ease forwards;}
.animate-scaleIn{animation:scaleIn 0.4s ease forwards;}
.animate-glow{animation:glow 2s ease infinite;}
.stagger>*:nth-child(1){animation-delay:0.05s;}
.stagger>*:nth-child(2){animation-delay:0.1s;}
.stagger>*:nth-child(3){animation-delay:0.15s;}
.stagger>*:nth-child(4){animation-delay:0.2s;}
.stagger>*:nth-child(5){animation-delay:0.25s;}
.stagger>*:nth-child(6){animation-delay:0.3s;}

